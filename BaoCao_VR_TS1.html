
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>VR-TS1 Bonepile Statistics Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1400px; margin: 0 auto; background: white; padding: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { color: #34495e; margin-top: 30px; border-left: 4px solid #3498db; padding-left: 10px; }
        .metric-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0; }
        .metric-box { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; text-align: center; }
        .metric-box.success { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
        .metric-box.warning { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .metric-box.info { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .metric-value { font-size: 32px; font-weight: bold; margin: 10px 0; }
        .metric-label { font-size: 14px; opacity: 0.9; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th { background: #3498db; color: white; padding: 12px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #ddd; }
        tr:hover { background: #f5f5f5; }
        .summary { background: #e8f5e9; padding: 20px; border-radius: 5px; margin: 20px 0; }
        .note-box { background: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“Š VR-TS1 BONEPILE STATISTICS REPORT</h1>
        <p><strong>Generated:</strong> 27/12/2025 22:58:53</p>
        <p><strong>Source:</strong> NV_IGS_VR144_Bonepile.xlsx - Sheet VR-TS1</p>
        
        <div class="note-box">
            <strong>ðŸ“‹ Statistics Logic:</strong><br>
            â€¢ Valid SN: Format 183XXXXXXXX (13 digits, starts with 183)<br>
            â€¢ Fail: PIC = IGS and result = FAIL<br>
            â€¢ Pass: Total unique SN - Fail unique<br>
            â€¢ Disposition: Each row with valid SN = 1 disposition (count duplicates)<br>
            â€¢ Completed disposition: Total disposition - SN Fail with empty IGS Action<br>
            â€¢ In process: IGS Status contains "waiting", "testing", "in process", "in progress"<br>
            â€¢ Waiting for material: Contains "waiting for material", "strata", "cx9"
        </div>
        
        <h2>1. TRAY SUMMARY</h2>
        <div class="metric-grid">
            <div class="metric-box">
                <div class="metric-label">Total Trays (Unique SN)</div>
                <div class="metric-value">134</div>
            </div>
            <div class="metric-box warning">
                <div class="metric-label">Tray Fail (Unique)</div>
                <div class="metric-value">26</div>
            </div>
            <div class="metric-box success">
                <div class="metric-label">Tray Pass (Unique)</div>
                <div class="metric-value">108</div>
            </div>
        </div>
        
        <h2>2. DISPOSITION STATISTICS</h2>
        <div class="metric-grid">
            <div class="metric-box info">
                <div class="metric-label">Total Dispositions</div>
                <div class="metric-value">332</div>
                <div class="metric-label" style="font-size: 11px; margin-top: 5px;">(Each row with valid SN = 1)</div>
            </div>
            <div class="metric-box success">
                <div class="metric-label">Completed Dispositions</div>
                <div class="metric-value">329</div>
            </div>
            <div class="metric-box warning">
                <div class="metric-label">SN Fail with Empty IGS Action</div>
                <div class="metric-value">3</div>
            </div>
        </div>
        
        <h2>3. IN-PROCESS DISPOSITIONS</h2>
        <div class="metric-grid">
            <div class="metric-box info">
                <div class="metric-label">In Process Dispositions</div>
                <div class="metric-value">14</div>
                <div class="metric-label" style="font-size: 11px; margin-top: 5px;">(13 unique SN)</div>
            </div>
            <div class="metric-box warning">
                <div class="metric-label">Waiting for Material</div>
                <div class="metric-value">5</div>
                <div class="metric-label" style="font-size: 11px; margin-top: 5px;">(5 unique SN)</div>
            </div>
        </div>
        
        <h2>4. AVERAGE DURATION</h2>
        <div class="summary">
            <table>
                <tr><th>Metric</th><th>Value</th></tr>
                <tr><td>Records with BP Duration (from completed dispositions)</td><td>311</td></tr>
                <tr><td>Average</td><td>0.75 days</td></tr>
                <tr><td>Median</td><td>0.60 days</td></tr>
                <tr><td>Min</td><td>0.10 days</td></tr>
                <tr><td>Max</td><td>2.40 days</td></tr>
                <tr><td>Standard Deviation</td><td>0.40 days</td></tr>
            </table>
        </div>
        
        <h2>5. DETAILED STATISTICS</h2>
        <table>
            <tr>
                <th>Item</th>
                <th>Value</th>
                <th>Note</th>
            </tr>
            <tr>
                <td>Total rows with valid SN</td>
                <td><strong>332</strong></td>
                <td>Each row = 1 disposition</td>
            </tr>
            <tr>
                <td>Total unique valid SN</td>
                <td><strong>134</strong></td>
                <td>Total trays (Fail + Pass)</td>
            </tr>
            <tr>
                <td>Fail rows (PIC=IGS, result=FAIL)</td>
                <td><strong>28</strong></td>
                <td>Count duplicates</td>
            </tr>
            <tr>
                <td>Unique SN Fail</td>
                <td><strong>26</strong></td>
                <td>No duplicates</td>
            </tr>
            <tr>
                <td>Unique SN Pass</td>
                <td><strong>108</strong></td>
                <td>Total unique - Fail unique</td>
            </tr>
            <tr>
                <td>SN Fail with empty IGS Action</td>
                <td><strong>3</strong></td>
                <td>Not completed</td>
            </tr>
            <tr>
                <td>Completed Dispositions</td>
                <td><strong>329</strong></td>
                <td>Total disposition - SN Fail empty action</td>
            </tr>
            <tr>
                <td>In Process Dispositions</td>
                <td><strong>14</strong></td>
                <td>IGS Status: waiting/testing/in process/in progress</td>
            </tr>
            <tr>
                <td>Waiting for Material</td>
                <td><strong>5</strong></td>
                <td>Contains: waiting for material/strata/cx9</td>
            </tr>
        </table>
        
        <hr>
        <p style="text-align: center; color: #7f8c8d; margin-top: 50px;">
            Report generated automatically from sheet VR-TS1<br>
            NV_IGS_VR144_Bonepile.xlsx
        </p>
    </div>
</body>
</html>
